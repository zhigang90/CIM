c mar 29 91 pp put in safegurds against infinite loop - it may happen
c   in dnode
c mar 26 91 pp fixed subroutine fm according to krzysztof's instructions
c may 31 pp remove ft05a - it is already in twofor3. add
c      it back if twofor3 is replaced
c  may 90 pp add higher functions needed for f and g functions
c==============================================================================
      subroutine ft0
      implicit real*8(a-h,o-z)
      common /rys/ t,rysr(10),rysw(10),xx,f0,f1,f2,f3,f4,f5,nroots
      dimension ff(0:1)
      call fm(t,1,ff)
      f0=ff(0)
      f1=ff(1)
      end
c==============================================================================
      subroutine fm(x,m,f)
c   this subroutine returns the incomplete gamma function values
c   F(0,x), F(1,x),.. F(m-1,x),F(m,x) in the vector f.
c   x must be non-negative, m is a non-negative integer
c   The actual function calculated is (2/sqrt(pi))*F(m,x)
c   Arguments
c   INTENT(IN)
c   x=argument of the incomplete gamma function
c   m=maximum order; m=0,1,2,..
c   INTENT(OUT)
c   f(i), i=0,m: the values of the function
      implicit real*8 (a-h,o-z)
      dimension f(0:*)
      parameter(r4=0.25d0,r3=1.0d0/3.0d0,r2=0.5d0)
      data twopi,half,zero,one,two/1.1283791670955126d0,0.5d0,0.0d0,
     & 1.0d0,2.0d0/
      common /fmtable1/ ff(0:24,500),gg(0:24,2000),rj(0:20)
c
      if (x.le.zero) then
c       write(*,*) 'fm(x) called with negative argument, x=',x
        do i=0,m
          f(i)=twopi*rj(i)
 1      end do
        return
      else if (x.ge.44.0d0) then
        f(0)=one/sqrt(x)
        rx=one/x
        do 300 i=1,m
           f(i)=f(i-1)*rx*(dble(i)-half)
 300    continue
        return
      else
        if(m.le.20) then
          if(x.lt.5.0d0) then
            ix=x*100+1
            dx=x-(ix+ix-1)*.005d0
            f1=(((ff(m+4,ix)*r4*dx-ff(m+3,ix))*r3*dx+ff(m+2,ix))*r2*dx-
     1          ff(m+1,ix))*dx+ff(m,ix)
c           print *,'ff',ff(m+4,ix),ff(m+3,ix),ff(m+2,ix),ff(m+1,ix),
c      1        	 ff(m,ix),dx,ix,f1
          else
            ix=(x-5.0d0)*50+1
            dx=x-5.0d0-(ix+ix-1)*0.01d0
            f1=(((gg(m+4,ix)*r4*dx-gg(m+3,ix))*r3*dx+gg(m+2,ix))*r2*dx-
     1          gg(m+1,ix))*dx+gg(m,ix)
c           print *,'gg',gg(m+4,ix),gg(m+3,ix),gg(m+2,ix),gg(m+1,ix),
c      1        	 gg(m,ix),dx,ix,f1
          end if
          f(m)=f1
          if(m.eq.0) return
          ex=exp(-x)*twopi
          twox=two*x
          j=m
  200     continue
            j=j-1
            f1=(ex+twox*f1)*rj(j)
            f(j)=f1
          if(j.gt.0) go to 200
        else
          call fm0(x,m,f)
        end if
      end if
      end
c==============================================================================
      subroutine ft05 (t,f0,f1,f2,f3,f4,f5)
      implicit real*8 (a-h,o-z)
      dimension ff(0:5)
      call fm(t,5,ff)
      f0=ff(0)
      f1=ff(1)
      f2=ff(2)
      f3=ff(3)
      f4=ff(4)
      f5=ff(5)
      end
c==============================================================================
      subroutine fprep
c  This routine prepares tables for the efficient calculation of the incomplete
c  gamma function. Two different tables are prepared: one for the argument
c  x=0 to 5 and one for 5 to 45. The first table contains F(m,x) for m=0..24,
c  and x=0.005(0.01)4.995. The second table contains F(m,x) for m=0..24,
c  c=5.01(0.02)44.99 A table of the reciprocals of the odd numbers is also calculated,
c  to avoid division. Note that the function is actually (2/sqrt(pi))*Fm(x)
      implicit real*8 (a-h,o-z)
      parameter (half=0.5d0,one=1.0d0)
      common /fmtable1/ ff(0:24,500),gg(0:24,2000),rj(0:20)
      dimension f(0:24)
      do i=1,500
        x=(i-half)*0.01d0
        call fm0(x,24,f)
        do j=0,24
          ff(j,i)=f(j)
        end do
      end do
      do i=1,2000
        x=5.0d0+(i-half)*0.02d0
        call fm0(x,24,f)
        do j=0,24
          gg(j,i)=f(j)
         end do
      end do
      do i=0,20
        rj(i)=one/dble(2*i+1)
      end do
      end
c
c==============================================================================
      subroutine fm0(x,m,f)
      implicit real*8 (a-h,o-z)
      dimension f(0:*)
      data twopi,half,zero,one,two/1.128379167096d0,0.5d0,0.0d0,
     & 1.0d0,2.0d0/
      if (x.le.zero) then
c       write(*,*) 'fm(x) called with negative argument, x=',x
        do 100 i=0,m
          f(i)=twopi/(2*i+1)
 100    continue
      else if (x.lt.30.0d0) then
        j=20+m/2.0+2.0*x
        ex=exp(-x)*twopi
        jj=j+j+1
        ff=ex/jj
        twox=two*x
 200      j=j-1
          jj=jj-2
c         ff=(ex+twox*ff)*rj(jj)
          ff=(ex+twox*ff)/jj
          if(j.le.m) f(j)=ff
          if(j.gt.0) go to 200
      else
        f(0)=one/sqrt(x)
        rx=one/x
        do 300 i=1,m
           f(i)=f(i-1)*rx*(i-half)
 300    continue
      end if
      end
c
c==============================================================================
      subroutine ft01 (t,f0,f1)
      implicit real*8(a-h,o-z)
c     common /rys/ t,rysr(10),rysw(10),xx,f0,f1,f2,f3,f4,f5,nroots
      dimension ff(0:1)
      call fm(t,1,ff)
      f0=ff(0)
      f1=ff(1)
      end
c==============================================================================
      subroutine rt123
      implicit real*8 (a-h,o-z)
c
c**** implicit real*8 (a-h,o-z) (a-h,o-z)
c             *****   version february 13,1975   *****
c
      common /rys/ x,u(10),w(10),t,f0,f1,f2,f3,f4,f5,nroots
      equivalence (u(1),rt1), (u(2),rt2), (u(3),rt3), (u(4),rt4), (u(5),
     1rt5)
      equivalence (w(1),ww1), (w(2),ww2), (w(3),ww3), (w(4),ww4), (w(5),
     1ww5)
      data r12,pie4/2.75255128608411d-01,7.85398163397448d-01/
      data r22,w22/2.72474487139158d+00,9.17517095361369d-02/
      data r13/1.90163509193487d-01/
      data r23,w23/1.78449274854325d+00,1.77231492083829d-01/
      data r33,w33/5.52534374226326d+00,5.11156880411248d-03/
      if (x.gt.5.0d+00) go to 150
      if (x.gt.1.0d+00) go to 90
      if (x.gt.3.0d-07) go to 40
c
c     x is approximately zero.         nroots=1,2, or 3
c
      if (nroots-2) 10,20,30
   10 rt1=0.5d+00-x/5.0d+00
      ww1=1.0d+00-x/3.0d+00
      return
   20 rt1=1.30693606237085d-01-2.90430236082028d-02*x
      rt2=2.86930639376291d+00-6.37623643058102d-01*x
      ww1=6.52145154862545d-01-1.22713621927067d-01*x
      ww2=3.47854845137453d-01-2.10619711404725d-01*x
      return
   30 rt1=6.03769246832797d-02-9.28875764357368d-03*x
      rt2=7.76823355931043d-01-1.19511285527878d-01*x
      rt3=6.66279971938567d+00-1.02504611068957d+00*x
      ww1=4.67913934572691d-01-5.64876917232519d-02*x
      ww2=3.60761573048137d-01-1.49077186455208d-01*x
      ww3=1.71324492379169d-01-1.27768455150979d-01*x
      return
c
c     x = 0.0 to 1.0                   nroots=1,2, or 3
c
   40 if (nroots.eq.3) go to 60
      f1=((((((((-8.36313918003957d-08*x+1.21222603512827d-06)*x-1.15662
     1609053481d-05)*x+9.25197374512647d-05)*x-6.40994113129432d-04)*x+3
     2.78787044215009d-03)*x-1.85185172458485d-02)*x+7.14285713298222d-0
     32)*x-1.99999999997023d-01)*x+3.33333333333318d-01
      ww1=(x+x)*f1+ exp(-x)
      if (nroots.eq.2) go to 50
      rt1=f1/(ww1-f1)
      return
   50 rt1=(((((((-2.35234358048491d-09*x+2.49173650389842d-08)*x-4.55831
     15364581d-08)*x-2.447252174587d-06)*x+4.743292959463d-05)*x-5.33184
     2749432408d-04)*x+4.44654947116579d-03)*x-2.90430236084697d-02)*x+1
     3.30693606237085d-01
      rt2=(((((((-2.47404902329170d-08*x+2.36809910635906d-07)*x+1.83536
     17736310d-06)*x-2.066168802076d-05)*x-1.345693393936d-04)*x-5.88154
     2362858038d-05)*x+5.32735082098139d-02)*x-6.37623643056745d-01)*x+2
     3.86930639376289d+00
      ww2=((f1-ww1)*rt1+f1)*(1.0d+00+rt2)/(rt2-rt1)
      ww1=ww1-ww2
      return
   60 rt1=((((((-5.10186691538870d-10*x+2.40134415703450d-08)*x-5.010810
     157744427d-07)*x+7.58291285499256d-06)*x-9.55085533670919d-05)*x+1.
     202893039315878d-03)*x-9.28875764374337d-03)*x+6.03769246832810d-02
      rt2=((((((-1.29646524960555d-08*x+7.74602292865683d-08)*x+1.560228
     111158727d-06)*x-1.58051990661661d-05)*x-3.30447806384059d-04)*x+9.
     274266885190267d-03)*x-1.19511285526388d-01)*x+7.76823355931033d-01
      rt3=((((((-9.28536484109606d-09*x-3.02786290067014d-07)*x-2.507344
     177064200d-06)*x-7.32728109752881d-06)*x+2.44217481700129d-04)*x+4.
     294758452357327d-02)*x-1.02504611065774d+00)*x+6.66279971938553d+00
      f2=((((((((-7.60911486098850d-08*x+1.09552870123182d-06)*x-1.03463
     1270693454d-05)*x+8.16324851790106d-05)*x-5.55526624875562d-04)*x+3
     2.20512054753924d-03)*x-1.51515139838540d-02)*x+5.55555554649585d-0
     32)*x-1.42857142854412d-01)*x+1.99999999999986d-01
   70 g= exp(-x)
      f1=((x+x)*f2+g)/3.0d+00
      ww1=(x+x)*f1+g
   80 t1=rt1/(rt1+1.0d+00)
      t2=rt2/(rt2+1.0d+00)
      t3=rt3/(rt3+1.0d+00)
      a2=f2-t1*f1
      a1=f1-t1*ww1
      ww3=(a2-t2*a1)/((t3-t2)*(t3-t1))
      ww2=(t3*a1-a2)/((t3-t2)*(t2-t1))
      ww1=ww1-ww2-ww3
      return
   90 if (x.gt.3.0d+00) go to 120
c
c     x = 1.0 to 3.0                   nroots=1,2, or 3
c
      y=x-2.0d+00
      if (nroots.eq.3) go to 110
      f1=((((((((((-1.61702782425558d-10*y+1.96215250865776d-09)*y-2.142
     134468198419d-08)*y+2.17216556336318d-07)*y-1.98850171329371d-06)*y
     2+1.62429321438911d-05)*y-1.16740298039895d-04)*y+7.24888732052332d
     3-04)*y-3.79490003707156d-03)*y+1.61723488664661d-02)*y-5.294281483
     429736d-02)*y+1.15702180856167d-01
      ww1=(x+x)*f1+ exp(-x)
      if (nroots.eq.2) go to 100
      rt1=f1/(ww1-f1)
      return
  100 rt1=(((((((((-6.36859636616415d-12*y+8.47417064776270d-11)*y-5.152
     1207846962d-10)*y-3.846389873308d-10)*y+8.472253388380d-08)*y-1.853
     206035634293d-06)*y+2.47191693238413d-05)*y-2.49018321709815d-04)*y
     3+2.19173220020161d-03)*y-1.63329339286794d-02)*y+8.68085688285261d
     4-02
      rt2=(((((((((1.45331350488343d-10*y+2.07111465297976d-09)*y-1.8789
     120917404d-08)*y-1.725838516261d-07)*y+2.247389642339d-06)*y+9.7678
     23813082564d-06)*y-1.93160765581969d-04)*y-1.58064140671893d-03)*y+
     34.85928174507904d-02)*y-4.30761584997596d-01)*y+1.80400974537950d+
     400
      ww2=((f1-ww1)*rt1+f1)*(1.0d+00+rt2)/(rt2-rt1)
      ww1=ww1-ww2
      return
  110 rt1=((((((((1.44687969563318d-12*y+4.85300143926755d-12)*y-6.55098
     1264095516d-10)*y+1.56592951656828d-08)*y-2.60122498274734d-07)*y+3
     2.86118485517386d-06)*y-5.13430986707889d-05)*y+6.03194524398109d-0
     34)*y-6.11219349825090d-03)*y+4.52578254679079d-02
      rt2=(((((((6.95964248788138d-10*y-5.35281831445517d-09)*y-6.745205
     1954533d-08)*y+1.502366784525d-06)*y+9.923326947376d-07)*y-3.891474
     269249594d-04)*y+7.51549330892401d-03)*y-8.48778120363400d-02)*y+5.
     373928229597613d-01
      rt3=((((((((-2.81496588401439d-10*y+3.61058041895031d-09)*y+4.5363
     11789436255d-08)*y-1.40971837780847d-07)*y-6.05865557561067d-06)*y-
     25.15964042227127d-05)*y+3.34761560498171d-05)*y+5.04871005319119d-
     302)*y-8.24708946991557d-01)*y+4.81234667357205d+00
      f2=((((((((((-1.48044231072140d-10*y+1.78157031325097d-09)*y-1.925
     114145088973d-08)*y+1.92804632038796d-07)*y-1.73806555021045d-06)*y
     2+1.39195169625425d-05)*y-9.74574633246452d-05)*y+5.83701488646511d
     3-04)*y-2.89955494844975d-03)*y+1.13847001113810d-02)*y-3.234469773
     420647d-02)*y+5.29428148329709d-02
      go to 70
c
c     x = 3.0 to 5.0                   nroots =1,2, or 3
c
  120 y=x-4.0d+00
      if (nroots.eq.3) go to 140
      f1=((((((((((-2.62453564772299d-11*y+3.24031041623823d-10)*y-3.614
     1965656163d-09)*y+3.760256799971d-08)*y-3.553558319675d-07)*y+3.022
     2556449731d-06)*y-2.290098979647d-05)*y+1.526537461148d-04)*y-8.819
     347375894379d-04)*y+4.33207949514611d-03)*y-1.75257821619926d-02)*y
     4+5.28406320615584d-02
      ww1=(x+x)*f1+ exp(-x)
      if (nroots.eq.2) go to 130
      rt1=f1/(ww1-f1)
      return
  130 rt1=((((((((-4.11560117487296d-12*y+7.10910223886747d-11)*y-1.7350
     18862390291d-09)*y+5.93066856324744d-08)*y-9.76085576741771d-07)*y+
     21.08484384385679d-05)*y-1.12608004981982d-04)*y+1.16210907653515d-
     303)*y-9.89572595720351d-03)*y+6.12589701086408d-02
      rt2=(((((((((-1.80555625241001d-10*y+5.44072475994123d-10)*y+1.603
     1498045240d-08)*y-1.497986283037d-07)*y-7.017002532106d-07)*y+1.858
     282653064034d-05)*y-2.04685420150802d-05)*y-2.49327728643089d-03)*y
     3+3.56550690684281d-02)*y-2.60417417692375d-01)*y+1.12155283108289d
     4+00
      ww2=((f1-ww1)*rt1+f1)*(1.0d+00+rt2)/(rt2-rt1)
      ww1=ww1-ww2
      return
  140 rt1=(((((((1.44265709189601d-11*y-4.66622033006074d-10)*y+7.649155
     1832025d-09)*y-1.229940017368d-07)*y+2.026002142457d-06)*y-2.870486
     271521677d-05)*y+3.70326938096287d-04)*y-4.21006346373634d-03)*y+3.
     350898470729044d-02
      rt2=((((((((-2.65526039155651d-11*y+1.97549041402552d-10)*y+2.1597
     11131403034d-09)*y-7.95045680685193d-08)*y+5.15021914287057d-07)*y+
     21.11788717230514d-05)*y-3.33739312603632d-04)*y+5.30601428208358d-
     303)*y-5.93483267268959d-02)*y+4.31180523260239d-01
      rt3=((((((((-3.92833750584041d-10*y-4.16423229782280d-09)*y+4.4241
     13039572867d-08)*y+6.40574545989551d-07)*y-3.05512456576552d-06)*y-
     21.05296443527943d-04)*y-6.14120969315617d-04)*y+4.89665802767005d-
     302)*y-6.24498381002855d-01)*y+3.36412312243724d+00
      f2=((((((((((-2.36788772599074d-11*y+2.89147476459092d-10)*y-3.181
     111322308846d-09)*y+3.25336816562485d-08)*y-3.00873821471489d-07)*y
     2+2.48749160874431d-06)*y-1.81353179793672d-05)*y+1.14504948737066d
     3-04)*y-6.10614987696677d-04)*y+2.64584212770942d-03)*y-8.664158990
     415349d-03)*y+1.75257821619922d-02
      go to 70
  150 if (x.gt.15.0d+00) go to 230
      g= exp(-x)
      if (x.gt.10.0d+00) go to 190
c
c     x = 5.0 to 10.0                  nroots =1,2, or 3
c
      ww1=((((((4.6897511375022d-01/x-6.9955602298985d-01)/x+5.368928327
     11887d-01)/x-3.2883030418398d-01)/x+2.4645596956002d-01)/x-4.998407
     22848436d-01)/x-3.1501078774085d-06)*g+sqrt(pie4/x)
      f1=(ww1-g)/(x+x)
      if (nroots-2) 160,170,180
  160 rt1=f1/(ww1-f1)
      return
  170 y=x-7.5d+00
      rt1=(((((((((((((-1.43632730148572d-16*y+2.38198922570405d-16)*y+1
     1.358319618800d-14)*y-7.064522786879d-14)*y-7.719300212748d-13)*y+7
     2.802544789997d-12)*y+6.628721099436d-11)*y-1.775564159743d-09)*y+1
     3.713828823990d-08)*y-1.497500187053d-07)*y+2.283485114279d-06)*y-3
     4.76953869614706d-05)*y+4.74791204651451d-04)*y-4.60448960876139d-0
     53)*y+3.72458587837249d-02
      rt2=((((((((((((2.48791622798900d-14*y-1.36113510175724d-13)*y-2.2
     124334349799d-12)*y+4.190559455515d-11)*y-2.222722579924d-10)*y-2.6
     224183464275d-09)*y+6.128153450169d-08)*y-4.383376014528d-07)*y-2.4
     39952200232910d-06)*y+1.03236647888320d-04)*y-1.44614664924989d-03)
     4*y+1.35094294917224d-02)*y-9.53478510453887d-02)*y+5.4476524568679
     50d-01
      ww2=((f1-ww1)*rt1+f1)*(1.0d+00+rt2)/(rt2-rt1)
      ww1=ww1-ww2
      return
  180 f2=(f1+f1+f1-g)/(x+x)
      y=x-7.5d+00
      rt1=(((((((((((5.74429401360115d-16*y+7.11884203790984d-16)*y-6.73
     16701449826d-14)*y-6.264613873998d-13)*y+1.315418927040d-11)*y-4.23
     2879635610964d-11)*y+1.39032379769474d-09)*y-4.65449552856856d-08)*
     3y+7.34609900170759d-07)*y-1.08656008854077d-05)*y+1.77930381549953
     4d-04)*y-2.39864911618015d-03)*y+2.39112249488821d-02
      rt2=(((((((((((1.13464096209120d-14*y+6.99375313934242d-15)*y-8.59
     15618132088d-13)*y-5.293620408757d-12)*y-2.492175211635d-11)*y+2.73
     2681574882729d-09)*y-1.06656985608482d-08)*y-4.40252529648056d-07)*
     3y+9.68100917793911d-06)*y-1.68211091755327d-04)*y+2.69443611274173
     4d-03)*y-3.23845035189063d-02)*y+2.75969447451882d-01
      rt3=((((((((((((6.66339416996191d-15*y+1.84955640200794d-13)*y-1.9
     185141104444d-12)*y-2.309293727603d-11)*y+3.917984522103d-10)*y+1.6
     263165279876d-09)*y-6.205591993923d-08)*y+8.769581622041d-09)*y+8.9
     37224398620038d-06)*y-3.14232666170796d-05)*y-1.83917335649633d-03)
     4*y+3.51246831672571d-02)*y-3.22335051270860d-01)*y+1.7358283175543
     50d+00
      go to 80
c
c     x = 10.0 to 15.0                 nroots=1,2, or 3
c
  190 ww1=(((-1.8784686463512d-01/x+2.2991849164985d-01)/x-4.98937525140
     147d-01)/x-2.1916512131607d-05)*g+sqrt(pie4/x)
      f1=(ww1-g)/(x+x)
      if (nroots-2) 200,210,220
  200 rt1=f1/(ww1-f1)
      return
  210 rt1=((((-1.01041157064226d-05*x+1.19483054115173d-03)*x-6.73760231
     1824074d-02)*x+1.25705571069895d+00)*x+(((-8.57609422987199d+03/x+5
     2.91005939591842d+03)/x-1.70807677109425d+03)/x+2.64536689959503d+0
     32)/x-2.38570496490846d+01)*g+r12/(x-r12)
      rt2=(((3.39024225137123d-04*x-9.34976436343509d-02)*x-4.2221648330
     16320d+00)*x+(((-2.08457050986847d+03/x-1.04999071905664d+03)/x+3.3
     29891508992661d+02)/x-1.56184800325063d+02)/x+8.00839033297501d+00)
     3*g+r22/(x-r22)
      ww2=((f1-ww1)*rt1+f1)*(1.0d+00+rt2)/(rt2-rt1)
      ww1=ww1-ww2
      return
  220 f2=(f1+f1+f1-g)/(x+x)
      y=x-12.5d+00
      rt1=(((((((((((4.42133001283090d-16*y-2.77189767070441d-15)*y-4.08
     14026087887d-14)*y+5.379885121517d-13)*y+1.882093066702d-12)*y-8.67
     2286219861085d-11)*y+7.11372337079797d-10)*y-3.55578027040563d-09)*
     3y+1.29454702851936d-07)*y-4.14222202791434d-06)*y+8.04427643593792
     4d-05)*y-1.18587782909876d-03)*y+1.53435577063174d-02
      rt2=(((((((((((6.85146742119357d-15*y-1.08257654410279d-14)*y-8.57
     19165965128d-13)*y+6.642452485783d-12)*y+4.798806828724d-11)*y-1.13
     2413908163831d-09)*y+7.08558457182751d-09)*y-5.59678576054633d-08)*
     3y+2.51020389884249d-06)*y-6.63678914608681d-05)*y+1.11888323089714
     4d-03)*y-1.45361636398178d-02)*y+1.65077877454402d-01
      rt3=((((((((((((3.20622388697743d-15*y-2.73458804864628d-14)*y-3.1
     157134329361d-13)*y+8.654129268056d-12)*y-5.625235879301d-11)*y-7.7
     218080513708d-10)*y+2.064664199164d-08)*y-1.567725007761d-07)*y-1.5
     37938204115055d-06)*y+6.27436306915967d-05)*y-1.01308723606946d-03)
     4*y+1.13901881430697d-02)*y-1.01449652899450d-01)*y+7.7720393733473
     59d-01
      go to 80
  230 if (x.gt.33.0d+00) go to 280
c
c     x = 15.0 to 33.0                 nroots=1,2, or 3
c
      g= exp(-x)
      ww1=((1.9623264149430d-01/x-4.9695241464490d-01)/x-6.0156581186481
     1d-05)*g+sqrt(pie4/x)
      f1=(ww1-g)/(x+x)
      if (nroots-2) 240,250,260
  240 rt1=f1/(ww1-f1)
      return
  250 rt1=((((-1.14906395546354d-06*x+1.76003409708332d-04)*x-1.71984023
     1644904d-02)*x-1.37292644149838d-01)*x+(-4.75742064274859d+01/x+9.2
     21005186542857d+00)/x-2.31080873898939d-02)*g+r12/(x-r12)
      rt2=(((3.64921633404158d-04*x-9.71850973831558d-02)*x-4.0288617485
     10252d+00)*x+(-1.35831002139173d+02/x-8.66891724287962d+01)/x+2.980
     211277766958d+00)*g+r22/(x-r22)
      ww2=((f1-ww1)*rt1+f1)*(1.0d+00+rt2)/(rt2-rt1)
      ww1=ww1-ww2
      return
  260 f2=(f1+f1+f1-g)/(x+x)
      if (x.gt.20.0d+00) go to 270
      rt1=((((((-2.43270989903742d-06*x+3.57901398988359d-04)*x-2.341124
     115981143d-02)*x+7.81425144913975d-01)*x-1.73209218219175d+01)*x+2.
     243517435690398d+02)*x+(-1.97611541576986d+04/x+9.82441363463929d+0
     33)/x-2.07970687843258d+03)*g+r13/(x-r13)
      rt2=(((((-2.62627010965435d-04*x+3.49187925428138d-02)*x-3.0933761
     18731880d+00)*x+1.07037141010778d+02)*x-2.36659637247087d+03)*x+((-
     22.91669113681020d+06/x+1.41129505262758d+06)/x-2.91532335433779d+0
     35)/x+3.35202872835409d+04)*g+r23/(x-r23)
      rt3=(((((9.31856404738601d-05*x-2.87029400759565d-02)*x-7.83503697
     1918455d-01)*x-1.84338896480695d+01)*x+4.04996712650414d+02)*x+(-1.
     289829509315154d+05/x+5.11498390849158d+04)/x-6.88145821789955d+03)
     3*g+r33/(x-r33)
      go to 80
  270 rt1=((((-4.97561537069643d-04*x-5.00929599665316d-02)*x+1.31099142
     1238996d+00)*x-1.88336409225481d+01)*x-6.60344754467191d+02/x+1.649
     231462413877d+02)*g+r13/(x-r13)
      rt2=((((-4.48218898474906d-03*x-5.17373211334924d-01)*x+1.13691058
     1739678d+01)*x-1.65426392885291d+02)*x-6.30909125686731d+03/x+1.522
     231757709236d+03)*g+r23/(x-r23)
      rt3=((((-1.38368602394293d-02*x-1.77293428863008d+00)*x+1.73639054
     1044562d+01)*x-3.57615122086961d+02)*x-1.45734701095912d+04/x+2.698
     231813951849d+03)*g+r33/(x-r33)
      go to 80
c
c     x = 33.0 to infinity             nroots=1,2, or 3
c
  280 ww1=sqrt(pie4/x)
      if (nroots-2) 290,300,310
  290 rt1=0.5d+00/(x-0.5d+00)
      return
  300 if (x.gt.40.0d+00) go to 320
      g= exp(-x)
      rt1=(-8.78947307498880d-01*x+1.09243702330261d+01)*g+r12/(x-r12)
      rt2=(-9.28903924275977d+00*x+8.10642367843811d+01)*g+r22/(x-r22)
      ww2=(4.46857389308400d+00*x-7.79250653461045d+01)*g+w22*ww1
      ww1=ww1-ww2
      return
  310 if (x.gt.47.0d+00) go to 330
      g= exp(-x)
      rt1=((-7.39058467995275d+00*x+3.21318352526305d+02)*x-3.9943369647
     13658d+03)*g+r13/(x-r13)
      rt2=((-7.38726243906513d+01*x+3.13569966333873d+03)*x-3.8686286731
     11321d+04)*g+r23/(x-r23)
      rt3=((-2.63750565461336d+02*x+1.04412168692352d+04)*x-1.2809457791
     15394d+05)*g+r33/(x-r33)
      ww3=(((1.52258947224714d-01*x-8.30661900042651d+00)*x+1.9297736796
     17984d+02)*x-1.67787926005344d+03)*g+w33*ww1
      ww2=((6.15072615497811d+01*x-2.91980647450269d+03)*x+3.80794303087
     1338d+04)*g+w23*ww1
      ww1=ww1-ww2-ww3
      return
  320 rt1=r12/(x-r12)
      rt2=r22/(x-r22)
      ww2=w22*ww1
      ww1=ww1-ww2
      return
  330 rt1=r13/(x-r13)
      rt2=r23/(x-r23)
      rt3=r33/(x-r33)
      ww2=w23*ww1
      ww3=w33*ww1
      ww1=ww1-ww2-ww3
      return
c
      end
c==============================================================================
      subroutine root4
      implicit real*8 (a-h,o-z)
c
c**** implicit real*8 (a-h,o-z)
c          *****   version february 16,1975   *****
c
      common /rys/ x,u(10),w(10),t,f0,f1,f2,f3,f4,f5,nroots
      equivalence (u(1),rt1), (u(2),rt2), (u(3),rt3), (u(4),rt4), (u(5),
     1rt5)
      equivalence (w(1),ww1), (w(2),ww2), (w(3),ww3), (w(4),ww4), (w(5),
     1ww5)
      data r14,pie4/1.45303521503316d-01,7.85398163397448d-01/
      data r24,w24/1.33909728812636d+00,2.34479815323517d-01/
      data r34,w34/3.92696350135829d+00,1.92704402415764d-02/
      data r44,w44/8.58863568901199d+00,2.25229076750736d-04/
      if (x.gt.15.0d+00) go to 50
      if (x.gt.5.0d+00) go to 30
      if (x.gt.1.0d+00) go to 20
      if (x.gt.3.0d-07) go to 10
c
c     x is approximately zero.                   nroots = 4
c
      rt1=3.48198973061471d-02-4.09645850660395d-03*x
      rt2=3.81567185080042d-01-4.48902570656719d-02*x
      rt3=1.73730726945891d+00-2.04389090547327d-01*x
      rt4=1.18463056481549d+01-1.39368301742312d+00*x
      ww1=3.62683783378362d-01-3.13844305713928d-02*x
      ww2=3.13706645877886d-01-8.98046242557724d-02*x
      ww3=2.22381034453372d-01-1.29314370958973d-01*x
      ww4=1.01228536290376d-01-8.28299075414321d-02*x
      return
c
c     x=0.0 to 1.0                               nroots = 4
c
   10 rt1=((((((-1.95309614628539d-10*x+5.19765728707592d-09)*x-1.017564
     152250573d-07)*x+1.72365935872131d-06)*x-2.61203523522184d-05)*x+3.
     252921308769880d-04)*x-4.09645850658433d-03)*x+3.48198973061469d-02
      rt2=(((((-1.89554881382342d-08*x+3.07583114342365d-07)*x+1.2709817
     134393d-06)*x-1.417298563884d-04)*x+3.226979163176d-03)*x-4.4890257
     20678178d-02)*x+3.81567185080039d-01
      rt3=((((((1.77280535300416d-09*x+3.36524958870615d-08)*x-2.5834152
     19013893d-07)*x-1.13644895662320d-05)*x-7.91549618884063d-05)*x+1.0
     23825827346828d-02)*x-2.04389090525137d-01)*x+1.73730726945889d+00
      rt4=(((((-5.61188882415248d-08*x-2.49480733072460d-07)*x+3.4286850
     157114d-06)*x+1.679007454539d-04)*x+4.722855585715d-02)*x-1.3936830
     21737828d+00)*x+1.18463056481543d+01
      ww1=((((((-1.14649303201279d-08*x+1.88015570196787d-07)*x-2.333058
     175372323d-06)*x+2.68880044371597d-05)*x-2.94268428977387d-04)*x+3.
     206548909776613d-03)*x-3.13844305680096d-02)*x+3.62683783378335d-01
      ww2=((((((((-4.11720483772634d-09*x+6.54963481852134d-08)*x-7.2004
     15285129626d-07)*x+6.93779646721723d-06)*x-6.05367572016373d-05)*x+
     24.74241566251899d-04)*x-3.26956188125316d-03)*x+1.91883866626681d-
     302)*x-8.98046242565811d-02)*x+3.13706645877886d-01
      ww3=((((((((-3.41688436990215d-08*x+5.07238960340773d-07)*x-5.0167
     15628408220d-06)*x+4.20363420922845d-05)*x-3.08040221166823d-04)*x+
     21.94431864731239d-03)*x-1.02477820460278d-02)*x+4.28670143840073d-
     302)*x-1.29314370962569d-01)*x+2.22381034453369d-01
      ww4=(((((((((4.99660550769508d-09*x-7.94585963310120d-08)*x+8.3590
     172409485d-07)*x-7.422369210610d-06)*x+5.763374308160d-05)*x-3.8664
     25606718233d-04)*x+2.18417516259781d-03)*x-9.99791027771119d-03)*x+
     33.48791097377370d-02)*x-8.28299075413889d-02)*x+1.01228536290376d-
     401
      return
c
c     x= 1.0 to 5.0                              nroots = 4
c
   20 y=x-3.0d+00
      rt1=(((((((((-1.48570633747284d-15*y-1.33273068108777d-13)*y+4.068
     1543696670d-12)*y-9.163164161821d-11)*y+2.046819017845d-09)*y-4.030
     276426299031d-08)*y+7.29407420660149d-07)*y-1.23118059980833d-05)*y
     3+1.88796581246938d-04)*y-2.53262912046853d-03)*y+2.51198234505021d
     4-02
      rt2=(((((((((1.35830583483312d-13*y-2.29772605964836d-12)*y-3.8215
     100128045d-12)*y+6.844424214735d-10)*y-1.048063352259d-08)*y+1.5008
     23186233363d-08)*y+3.48848942324454d-06)*y-1.08694174399193d-04)*y+
     32.08048885251999d-03)*y-2.91205805373793d-02)*y+2.72276489515713d-
     401
      rt3=(((((((((5.02799392850289d-13*y+1.07461812944084d-11)*y-1.4822
     177886411d-10)*y-2.153585661215d-09)*y+3.654087802817d-08)*y+5.1592
     29575830120d-07)*y-9.52388379435709d-06)*y-2.16552440036426d-04)*y+
     39.03551469568320d-03)*y-1.45505469175613d-01)*y+1.21449092319186d+
     400
      rt4=(((((((((-1.08510370291979d-12*y+6.41492397277798d-11)*y+7.542
     1387436125d-10)*y-2.213111836647d-09)*y-1.448228963549d-07)*y-1.956
     270833237101d-06)*y-1.07481314670844d-05)*y+1.49335941252765d-04)*y
     3+4.87791531990593d-02)*y-1.10559909038653d+00)*y+8.09502028611780d
     4+00
      ww1=((((((((((-4.65801912689961d-14*y+7.58669507106800d-13)*y-1.18
     16387548048d-11)*y+1.862334710665d-10)*y-2.799399389539d-09)*y+4.14
     28972684255d-08)*y-5.933568079600d-07)*y+8.168349266115d-06)*y-1.08
     3989176177409d-04)*y+1.41357961729531d-03)*y-1.87588361833659d-02)*
     4y+2.89898651436026d-01
      ww2=((((((((((((-1.46345073267549d-14*y+2.25644205432182d-13)*y-3.
     1116258693847d-12)*y+4.321908756610d-11)*y-5.673270062669d-10)*y+7.
     2006295962960d-09)*y-8.120186517000d-08)*y+8.775294645770d-07)*y-8.
     377829235749024d-06)*y+8.04372147732379d-05)*y-6.64149238804153d-04
     4)*y+4.81181506827225d-03)*y-2.88982669486183d-02)*y+1.562472499792
     588d-01
      ww3=(((((((((((((9.06812118895365d-15*y-1.40541322766087d-13)*y+1.
     1919270015269d-12)*y-2.605135739010d-11)*y+3.299685839012d-10)*y-3.
     286354139348735d-09)*y+4.16265847927498d-08)*y-4.09462835471470d-07
     3)*y+3.64018881086111d-06)*y-2.88665153269386d-05)*y+2.005158197890
     428d-04)*y-1.18791896897934d-03)*y+5.75223633388589d-03)*y-2.094004
     518772687d-02)*y+4.85368861938873d-02
      ww4=((((((((((((((-9.74835552342257d-16*y+1.57857099317175d-14)*y-
     12.249993780112d-13)*y+3.173422008953d-12)*y-4.161159459680d-11)*y+
     25.021343560166d-10)*y-5.545047534808d-09)*y+5.554146993491d-08)*y-
     34.99048696190133d-07)*y+3.96650392371311d-06)*y-2.73816413291214d-
     405)*y+1.60106988333186d-04)*y-7.64560567879592d-04)*y+2.8133004442
     56892d-03)*y-7.16227030134947d-03)*y+9.66077262223353d-03
      return
   30 if (x.gt.10.0d+00) go to 40
c
c     x=5.0 to 10.0                              nroots = 4
c
      y=x-7.5d+00
      rt1=(((((((((4.64217329776215d-15*y-6.27892383644164d-15)*y+3.4622
     136347446d-13)*y-2.927229355350d-11)*y+5.090355371676d-10)*y-9.9727
     22656345253d-09)*y+2.37835295639281d-07)*y-4.60301761310921d-06)*y+
     38.42824204233222d-05)*y-1.37983082233081d-03)*y+1.66630865869375d-
     402
      rt2=(((((((((2.93981127919047d-14*y+8.47635639065744d-13)*y-1.4463
     114544774d-11)*y-6.149155555753d-12)*y+8.484275604612d-10)*y-6.1089
     28827887652d-08)*y+2.39156093611106d-06)*y-5.35837089462592d-05)*y+
     31.00967602595557d-03)*y-1.57769317127372d-02)*y+1.74853819464285d-
     401
      rt3=((((((((((2.93523563363000d-14*y-6.40041776667020d-14)*y-2.695
     1740446312d-12)*y+1.027082960169d-10)*y-5.822038656780d-10)*y-3.159
     2991002539d-08)*y+4.327249251331d-07)*y+4.856768455119d-06)*y-2.546
     317989427762d-04)*y+5.54843378106589d-03)*y-7.95013029486684d-02)*y
     4+7.20206142703162d-01
      rt4=(((((((((((-1.62212382394553d-14*y+7.68943641360593d-13)*y+5.7
     164015756615d-12)*y-1.380635298784d-10)*y-1.476849808675d-09)*y+1.8
     24347052385605d-08)*y+3.34382940759405d-07)*y-1.39428366421645d-06)
     3*y-7.50249313713996d-05)*y-6.26495899187507d-04)*y+4.6971641090116
     42d-02)*y-6.66871297428209d-01)*y+4.11207530217806d+00
      ww1=((((((((((-1.65995045235997d-15*y+6.91838935879598d-14)*y-9.13
     11223418888d-13)*y+1.403341829454d-11)*y-3.672235069444d-10)*y+6.36
     26962546990d-09)*y-1.039220021671d-07)*y+1.959098751715d-06)*y-3.33
     3474893152939d-05)*y+5.72164211151013d-04)*y-1.05583210553392d-02)*
     4y+2.26696066029591d-01
      ww2=((((((((((((-3.57248951192047d-16*y+6.25708409149331d-15)*y-9.
     1657033089714d-14)*y+1.507864898748d-12)*y-2.332522256110d-11)*y+3.
     2428545616603d-10)*y-4.698730937661d-09)*y+6.219977635130d-08)*y-7.
     383008889613661d-07)*y+9.08621687041567d-06)*y-9.86368311253873d-05
     4)*y+9.69632496710088d-04)*y-8.14594214284187d-03)*y+8.502184477334
     557d-02
      ww3=(((((((((((((1.64742458534277d-16*y-2.68512265928410d-15)*y+3.
     1788890667676d-14)*y-5.508918529823d-13)*y+7.555896810069d-12)*y-9.
     269039768312637d-11)*y+1.16034263529672d-09)*y-1.28771698573873d-08
     3)*y+1.31949431805798d-07)*y-1.23673915616005d-06)*y+1.041898035449
     436d-05)*y-7.79566003744742d-05)*y+5.03162624754434d-04)*y-2.551388
     544587555d-03)*y+1.13250730954014d-02
      ww4=((((((((((((((-1.55714130075679d-17*y+2.57193722698891d-16)*y-
     13.626606654097d-15)*y+5.234734676175d-14)*y-7.067105402134d-13)*y+
     28.793512664890d-12)*y-1.006088923498d-10)*y+1.050565098393d-09)*y-
     39.91517881772662d-09)*y+8.35835975882941d-08)*y-6.19785782240693d-
     407)*y+3.95841149373135d-06)*y-2.11366761402403d-05)*y+9.0047477122
     59507d-05)*y-2.78777909813289d-04)*y+5.26543779837487d-04
      return
c
c     x=10.0 to 15.0                             nroots = 4
c
   40 y=x-12.5d+00
      rt1=(((((((((((4.94869622744119d-17*y+8.03568805739160d-16)*y-5.59
     19125915431d-15)*y-1.378685560217d-13)*y+7.006511663249d-13)*y+1.30
     2391406991118d-11)*y+8.06987313467541d-11)*y-5.20644072732933d-09)*
     3y+7.72794187755457d-08)*y-1.61512612564194d-06)*y+4.15083811185831
     4d-05)*y-7.87855975560199d-04)*y+1.14189319050009d-02
      rt2=(((((((((((4.89224285522336d-16*y+1.06390248099712d-14)*y-5.44
     16260182933d-14)*y-1.613630106295d-12)*y+3.910179118937d-12)*y+1.90
     2712434258806d-10)*y+8.78470199094761d-10)*y-5.97332993206797d-08)*
     3y+9.25750831481589d-07)*y-2.02362185197088d-05)*y+4.92341968336776
     4d-04)*y-8.68438439874703d-03)*y+1.15825965127958d-01
      rt3=((((((((((6.12419396208408d-14*y+1.12328861406073d-13)*y-9.051
     1094103059d-12)*y-4.781797525341d-11)*y+1.660828868694d-09)*y+4.499
     2058798868d-10)*y-2.519549641933d-07)*y+4.977444040180d-06)*y-1.258
     358350034589d-04)*y+2.70279176970044d-03)*y-3.99327850801083d-02)*y
     4+4.33467200855434d-01
      rt4=(((((((((((4.63414725924048d-14*y-4.72757262693062d-14)*y-1.00
     11926833832d-11)*y+6.074107718414d-11)*y+1.576976911942d-09)*y-2.01
     2186401974027d-08)*y-1.84530195217118d-07)*y+5.02333087806827d-06)*
     3y+9.66961790843006d-06)*y-1.58522208889528d-03)*y+2.80539673938339
     4d-02)*y-2.78953904330072d-01)*y+1.82835655238235d+00
      ww4=(((((((((((((2.90401781000996d-18*y-4.63389683098251d-17)*y+6.
     1274018198326d-16)*y-8.936002188168d-15)*y+1.194719074934d-13)*y-1.
     245501321259466d-12)*y+1.64090830181013d-11)*y-1.71987745310181d-10
     3)*y+1.63738403295718d-09)*y-1.39237504892842d-08)*y+1.065273181421
     451d-07)*y-7.27634957230524d-07)*y+4.12159381310339d-06)*y-1.746481
     569719173d-05)*y+8.50290130067818d-05
      ww3=((((((((((((-4.19569145459480d-17*y+5.94344180261644d-16)*y-1.
     1148797566469d-14)*y+1.881303962576d-13)*y-2.413554618391d-12)*y+3.
     2372127423047d-11)*y-4.933988617784d-10)*y+6.116545396281d-09)*y-6.
     369965691739299d-08)*y+7.52380085447161d-07)*y-8.08708393262321d-06
     4)*y+6.88603417296672d-05)*y-4.67067112993427d-04)*y+5.423133658645
     597d-03
      ww2=((((((((((-6.22272689880615d-15*y+1.04126809657554d-13)*y-6.84
     12418230913d-13)*y+1.576841731919d-11)*y-4.203948834175d-10)*y+6.28
     27255934781d-09)*y-8.307159819228d-08)*y+1.356478091922d-06)*y-2.08
     3065576105639d-05)*y+2.52396730332340d-04)*y-2.94484050194539d-03)*
     4y+6.01396183129168d-02
      ww1=(((-1.8784686463512d-01/x+2.2991849164985d-01)/x-4.98937525140
     147d-01)/x-2.1916512131607d-05)* exp(-x)+sqrt(pie4/x)-ww4-ww3-ww2
      return
   50 ww1=sqrt(pie4/x)
      if (x.gt.35.0d+00) go to 70
      if (x.gt.20.0d+00) go to 60
c
c     x=15.0 to 20.0                             nroots = 4
c
      y=x-17.5d+00
      rt1=(((((((((((4.36701759531398d-17*y-1.12860600219889d-16)*y-6.14
     19849164164d-15)*y+5.820231579541d-14)*y+4.396602872143d-13)*y-1.24
     2330365320172d-11)*y+6.71083474044549d-11)*y+2.43865205376067d-10)*
     3y+1.67559587099969d-08)*y-9.32738632357572d-07)*y+2.39030487004977
     4d-05)*y-4.68648206591515d-04)*y+8.34977776583956d-03
      rt2=(((((((((((4.98913142288158d-16*y-2.60732537093612d-16)*y-7.77
     15156445127d-14)*y+5.766105220086d-13)*y+6.432696729600d-12)*y-1.39
     2571683725792d-10)*y+5.95451479522191d-10)*y+2.42471442836205d-09)*
     3y+2.47485710143120d-07)*y-1.14710398652091d-05)*y+2.71252453754519
     4d-04)*y-4.96812745851408d-03)*y+8.26020602026780d-02
      rt3=(((((((((((1.91498302509009d-15*y+1.48840394311115d-14)*y-4.31
     16925145767d-13)*y+1.186495793471d-12)*y+4.615806713055d-11)*y-5.54
     2336148667141d-10)*y+3.48789978951367d-10)*y-2.79188977451042d-09)*
     3y+2.09563208958551d-06)*y-6.76512715080324d-05)*y+1.32129867629062
     4d-03)*y-2.05062147771513d-02)*y+2.88068671894324d-01
      rt4=(((((((((((-5.43697691672942d-15*y-1.12483395714468d-13)*y+2.8
     126607936174d-12)*y-1.266734493280d-11)*y-4.258722866437d-10)*y+9.4
     25486578503261d-09)*y-5.86635622821309d-08)*y-1.28835028104639d-06)
     3*y+4.41413815691885d-05)*y-7.61738385590776d-04)*y+9.6609090298555
     40d-03)*y-1.01410568057649d-01)*y+9.54714798156712d-01
      ww4=((((((((((((-7.56882223582704d-19*y+7.53541779268175d-18)*y-1.
     1157318032236d-16)*y+2.411195002314d-15)*y-3.601794386996d-14)*y+4.
     2082150659615d-13)*y-4.289542980767d-12)*y+5.086829642731d-11)*y-6.
     335435561050807d-10)*y+6.82309323251123d-09)*y-5.63374555753167d-08
     4)*y+3.57005361100431d-07)*y-2.40050045173721d-06)*y+4.941713005363
     597d-05
      ww3=(((((((((((-5.54451040921657d-17*y+2.68748367250999d-16)*y+1.3
     149020069254d-14)*y-2.507452792892d-13)*y+1.944339743818d-12)*y-1.2
     29816917658823d-11)*y+3.49977768819641d-10)*y-8.67270669346398d-09)
     3*y+1.31381116840118d-07)*y-1.36790720600822d-06)*y+1.1921069767316
     40d-05)*y-1.42181943986587d-04)*y+4.12615396191829d-03
      ww2=(((((((((((-1.86506057729700d-16*y+1.16661114435809d-15)*y+2.5
     163712856363d-14)*y-4.498350984631d-13)*y+1.765194089338d-12)*y+9.0
     24483676345625d-12)*y+4.98930345609785d-10)*y-2.11964170928181d-08)
     3*y+3.98295476005614d-07)*y-5.49390160829409d-06)*y+7.7406515535326
     42d-05)*y-1.48201933009105d-03)*y+4.97836392625268d-02
      ww1=((1.9623264149430d-01/x-4.9695241464490d-01)/x-6.0156581186481
     1d-05)* exp(-x)+ww1-ww2-ww3-ww4
      return
c
c     x=20.0 to 35.0                             nroots = 4
c
   60 g= exp(-x)
      rt1=((((((-4.45711399441838d-05*x+1.27267770241379d-03)*x-2.369549
     161381262d-01)*x+1.54330657903756d+01)*x-5.22799159267808d+02)*x+1.
     205951216669313d+04)*x+(-2.51177235556236d+06/x+8.72975373557709d+0
     35)/x-1.29194382386499d+05)*g+r14/(x-r14)
      rt2=(((((-7.85617372254488d-02*x+6.35653573484868d+00)*x-3.3829693
     18763990d+02)*x+1.25120495802096d+04)*x-3.16847570511637d+05)*x+((-
     21.02427466127427d+09/x+3.70104713293016d+08)/x-5.87119005093822d+0
     37)/x+5.38614211391604d+06)*g+r24/(x-r24)
      rt3=(((((-2.37900485051067d-01*x+1.84122184400896d+01)*x-1.0020073
     11304146d+03)*x+3.75151841595736d+04)*x-9.50626663390130d+05)*x+((-
     22.88139014651985d+09/x+1.06625915044526d+09)/x-1.72465289687396d+0
     38)/x+1.60419390230055d+07)*g+r34/(x-r34)
      rt4=((((((-6.00691586407385d-04*x-3.64479545338439d-01)*x+1.574961
     131755179d+01)*x-6.54944248734901d+02)*x+1.70830039597097d+04)*x-2.
     290517939780207d+05)*x+(+3.49059698304732d+07/x-1.64944522586065d+0
     37)/x+2.96817940164703d+06)*g+r44/(x-r44)
      if (x.le.25.0d+00) ww4=(((((((2.33766206773151d-07*x-3.81542906607
     1063d-05)*x+3.51416601267000d-03)*x-1.66538571864728d-01)*x+4.80006
     2136831847d+00)*x-8.73165934223603d+01)*x+9.77683627474638d+02)*x+1
     3.66000945117640d+04/x-6.14479071209961d+03)*g+w44*ww1
      if (x.gt.25.0d+00) ww4=((((((5.74245945342286d-06*x-7.587359281023
     151d-05)*x+2.35072857922892d-04)*x-3.78812134013125d-03)*x+3.098716
     252785805d-01)*x-7.11108633061306d+00)*x+5.55297573149528d+01)*g+w4
     34*ww1
      ww3=((((((2.36392855180768d-04*x-9.16785337967013d-03)*x+4.6218652
     15041313d-01)*x-1.96943786006540d+01)*x+4.99169195295559d+02)*x-6.2
     21419845845090d+03)*x+((+5.21445053212414d+07/x-1.34113464389309d+0
     37)/x+1.13673298305631d+06)/x-2.81501182042707d+03)*g+w34*ww1
      ww2=((((((7.29841848989391d-04*x-3.53899555749875d-02)*x+2.0779742
     15718513d+00)*x-1.00464709786287d+02)*x+3.15206108877819d+03)*x-6.2
     27054715090012d+04)*x+(+1.54721246264919d+07/x-5.26074391316381d+06
     3)/x+7.67135400969617d+05)*g+w24*ww1
      ww1=((1.9623264149430d-01/x-4.9695241464490d-01)/x-6.0156581186481
     1d-05)*g+ww1-ww2-ww3-ww4
      return
   70 if (x.gt.53.0d+00) go to 80
c
c     x=35.0 to 53.0                             nroots = 4
c
      g= exp(-x)*(x*x)**2
      rt4=((-2.19135070169653d-03*x-1.19108256987623d-01)*x-7.5023879569
     15573d-01)*g+r44/(x-r44)
      rt3=((-9.65842534508637d-04*x-4.49822013469279d-02)*x+6.0878403334
     17757d-01)*g+r34/(x-r34)
      rt2=((-3.62569791162153d-04*x-9.09231717268466d-03)*x+1.8433676055
     16262d-01)*g+r24/(x-r24)
      rt1=((-4.07557525914600d-05*x-6.88846864931685d-04)*x+1.7472530919
     19384d-02)*g+r14/(x-r14)
      ww4=((5.76631982000990d-06*x-7.89187283804890d-05)*x+3.28297971853
     1126d-04)*g+w44*ww1
      ww3=((2.08294969857230d-04*x-3.77489954837361d-03)*x+2.09857151617
     1436d-02)*g+w34*ww1
      ww2=((6.16374517326469d-04*x-1.26711744680092d-02)*x+8.14504890732
     1155d-02)*g+w24*ww1
      ww1=ww1-ww2-ww3-ww4
      return
c
c     x=47.0 to infinity                         nroots = 4
c
   80 rt1=r14/(x-r14)
      rt2=r24/(x-r24)
      rt3=r34/(x-r34)
      rt4=r44/(x-r44)
      ww4=w44*ww1
      ww3=w34*ww1
      ww2=w24*ww1
      ww1=ww1-ww2-ww3-ww4
      return
c
      end
c==============================================================================
      subroutine root5
      implicit real*8 (a-h,o-z)
c
c**** implicit real*8 (a-h,o-z)
c          *****   version  february 27,1975   *****
c
      common /rys/ x,u(10),w(10),t,f0,f1,f2,f3,f4,f5,nroots
      equivalence (u(1),rt1), (u(2),rt2), (u(3),rt3), (u(4),rt4), (u(5),
     1rt5)
      equivalence (w(1),ww1), (w(2),ww2), (w(3),ww3), (w(4),ww4), (w(5),
     1ww5)
      data r15,pie4/1.17581320211778d-01,7.85398163397448d-01/
      data r25,w25/1.07456201243690d+00,2.70967405960535d-01/
      data r35,w35/3.08593744371754d+00,3.82231610015404d-02/
      data r45,w45/6.41472973366203d+00,1.51614186862443d-03/
      data r55,w55/1.18071894899717d+01,8.62130526143657d-06/
      if (x.gt.15.0d+00) go to 50
      if (x.gt.5.0d+00) go to 30
      if (x.gt.1.0d+00) go to 20
      if (x.gt.3.0d-07) go to 10
c
c     x is approximately zero.                   nroots = 5
c
      rt1=2.26659266316985d-02-2.15865967920897d-03*x
      rt2=2.31271692140903d-01-2.20258754389745d-02*x
      rt3=8.57346024118836d-01-8.16520023025515d-02*x
      rt4=2.97353038120346d+00-2.83193369647137d-01*x
      rt5=1.84151859759051d+01-1.75382723579439d+00*x
      ww1=2.95524224714752d-01-1.96867576909777d-02*x
      ww2=2.69266719309995d-01-5.61737590184721d-02*x
      ww3=2.19086362515981d-01-9.71152726793658d-02*x
      ww4=1.49451349150580d-01-1.02979262193565d-01*x
      ww5=6.66713443086877d-02-5.73782817488315d-02*x
      return
c
c     x=0.0 to 1.0                               nroots = 5
c
   10 rt1=((((((-4.46679165328413d-11*x+1.21879111988031d-09)*x-2.629750
     122612104d-08)*x+5.15106194905897d-07)*x-9.27933625824749d-06)*x+1.
     251794097682482d-04)*x-2.15865967920301d-03)*x+2.26659266316985d-02
      rt2=((((((1.93117331714174d-10*x-4.57267589660699d-09)*x+2.4833990
     18218932d-08)*x+1.50716729438474d-06)*x-6.07268757707381d-05)*x+1.3
     27506939145643d-03)*x-2.20258754419939d-02)*x+2.31271692140905d-01
      rt3=(((((4.84989776180094d-09*x+1.31538893944284d-07)*x-2.76675385
     12879d-06)*x-7.651163510626d-05)*x+4.033058545972d-03)*x-8.16520022
     2916145d-02)*x+8.57346024118779d-01
      rt4=((((-2.48581772214623d-07*x-4.34482635782585d-06)*x-7.46018257
     1987630d-07)*x+1.01210776517279d-02)*x-2.83193369640005d-01)*x+2.97
     2353038120345d+00
      rt5=(((((-8.92432153868554d-09*x+1.77288899268988d-08)*x+3.0407546
     180666d-06)*x+1.058229325071d-04)*x+4.596379534985d-02)*x-1.7538272
     23579114d+00)*x+1.84151859759049d+01
      ww1=((((((-2.03822632771791d-09*x+3.89110229133810d-08)*x-5.849147
     187904823d-07)*x+8.30316168666696d-06)*x-1.13218402310546d-04)*x+1.
     249128888586790d-03)*x-1.96867576904816d-02)*x+2.95524224714749d-01
      ww2=(((((((8.62848118397570d-09*x-1.38975551148989d-07)*x+1.602894
     1068228d-06)*x-1.646364300836d-05)*x+1.538445806778d-04)*x-1.288488
     268034502d-03)*x+9.38866933338584d-03)*x-5.61737590178812d-02)*x+2.
     369266719309991d-01
      ww3=((((((((-9.41953204205665d-09*x+1.47452251067755d-07)*x-1.5745
     16991199322d-06)*x+1.45098401798393d-05)*x-1.18858834181513d-04)*x+
     28.53697675984210d-04)*x-5.22877807397165d-03)*x+2.60854524809786d-
     302)*x-9.71152726809059d-02)*x+2.19086362515979d-01
      ww4=((((((((-3.84961617022042d-08*x+5.66595396544470d-07)*x-5.5235
     11805403748d-06)*x+4.53160377546073d-05)*x-3.22542784865557d-04)*x+
     21.95682017370967d-03)*x-9.77232537679229d-03)*x+3.79455945268632d-
     302)*x-1.02979262192227d-01)*x+1.49451349150573d-01
      ww5=(((((((((4.09594812521430d-09*x-6.47097874264417d-08)*x+6.7435
     141482689d-07)*x-5.917993920224d-06)*x+4.531969237381d-05)*x-2.9910
     22856679638d-04)*x+1.65695765202643d-03)*x-7.40671222520653d-03)*x+
     32.50889946832192d-02)*x-5.73782817487958d-02)*x+6.66713443086877d-
     402
      return
c
c     x=1.0 to 5.0                               nroots = 5
c
   20 y=x-3.0d+00
      rt1=((((((((-2.58163897135138d-14*y+8.14127461488273d-13)*y-2.1141
     14838976129d-11)*y+5.09822003260014d-10)*y-1.16002134438663d-08)*y+
     22.46810694414540d-07)*y-4.92556826124502d-06)*y+9.02580687971053d-
     305)*y-1.45190025120726d-03)*y+1.73416786387475d-02
      rt2=(((((((((1.04525287289788d-14*y+5.44611782010773d-14)*y-4.8310
     159411392d-12)*y+1.136643908832d-10)*y-1.104373076913d-09)*y-2.3534
     26740649916d-08)*y+1.43772622028764d-06)*y-4.23405023015273d-05)*y+
     39.12034574793379d-04)*y-1.52479441718739d-02)*y+1.76055265928744d-
     401
      rt3=(((((((((-6.89693150857911d-14*y+5.92064260918861d-13)*y+1.847
     1170956043d-11)*y-3.390752744265d-10)*y-2.995532064116d-09)*y+1.574
     256141058535d-07)*y-3.95859409711346d-07)*y-9.58924580919747d-05)*y
     3+3.23551502557785d-03)*y-5.97587007636479d-02)*y+6.46432853383057d
     4-01
      rt4=((((((((-3.61293809667763d-12*y-2.70803518291085d-11)*y+8.8375
     18848468769d-10)*y+1.59166632851267d-08)*y-1.32581997983422d-07)*y-
     27.60223407443995d-06)*y-7.41019244900952d-05)*y+9.81432631743423d-
     303)*y-2.23055570487771d-01)*y+2.21460798080643d+00
      rt5=(((((((((7.12332088345321d-13*y+3.16578501501894d-12)*y-8.7766
     168218053d-11)*y-2.342817613343d-09)*y-3.496962018025d-08)*y-3.0317
     22870136802d-07)*y+1.50511293969805d-06)*y+1.37704919387696d-04)*y+
     34.70723869619745d-02)*y-1.47486623003693d+00)*y+1.35704792175847d+
     401
      ww1=(((((((((1.04348658616398d-13*y-1.94147461891055d-12)*y+3.4855
     112360993d-11)*y-6.277497362235d-10)*y+1.100758247388d-08)*y-1.8832
     29804969573d-07)*y+3.12338120839468d-06)*y-5.04404167403568d-05)*y+
     38.00338056610995d-04)*y-1.30892406559521d-02)*y+2.47383140241103d-
     401
      ww2=(((((((((((3.23496149760478d-14*y-5.24314473469311d-13)*y+7.74
     13219385056d-12)*y-1.146022750992d-10)*y+1.615238462197d-09)*y-2.15
     2479017572233d-08)*y+2.70933462557631d-07)*y-3.18750295288531d-06)*
     3y+3.47425221210099d-05)*y-3.45558237388223d-04)*y+3.05779768191621
     4d-03)*y-2.29118251223003d-02)*y+1.59834227924213d-01
      ww3=((((((((((((-3.42790561802876d-14*y+5.26475736681542d-13)*y-7.
     1184330797139d-12)*y+9.763932908544d-11)*y-1.244014559219d-09)*y+1.
     2472744068942d-08)*y-1.611749975234d-07)*y+1.616487851917d-06)*y-1.
     346852359124154d-05)*y+1.18900349101069d-04)*y-8.37562373221756d-04
     4)*y+4.93752683045845d-03)*y-2.25514728915673d-02)*y+6.952118124539
     529d-02
      ww4=(((((((((((((1.04072340345039d-14*y-1.60808044529211d-13)*y+2.
     1183534866798d-12)*y-2.939403008391d-11)*y+3.679254029085d-10)*y-4.
     223775673047899d-09)*y+4.46559231067006d-08)*y-4.26488836563267d-07
     3)*y+3.64721335274973d-06)*y-2.74868382777722d-05)*y+1.785861188674
     488d-04)*y-9.68428981886534d-04)*y+4.16002324339929d-03)*y-1.282901
     592663141d-02)*y+2.22353727685016d-02
      ww5=((((((((((((((-8.16770412525963d-16*y+1.31376515047977d-14)*y-
     11.856950818865d-13)*y+2.596836515749d-12)*y-3.372639523006d-11)*y+
     24.025371849467d-10)*y-4.389453269417d-09)*y+4.332753856271d-08)*y-
     33.82673275931962d-07)*y+2.98006900751543d-06)*y-2.00718990300052d-
     405)*y+1.13876001386361d-04)*y-5.23627942443563d-04)*y+1.8352456511
     58203d-03)*y-4.37785737450783d-03)*y+5.36963805223095d-03
      return
   30 if (x.gt.10.0d+00) go to 40
c
c     x=5.0 to 10.0                              nroots = 5
c
      y=x-7.5d+00
      rt1=((((((((-1.13825201010775d-14*y+1.89737681670375d-13)*y-4.8156
     11201185876d-12)*y+1.56666512163407d-10)*y-3.73782213255083d-09)*y+
     29.15858355075147d-08)*y-2.13775073585629d-06)*y+4.56547356365536d-
     305)*y-8.68003909323740d-04)*y+1.22703754069176d-02
      rt2=(((((((((-3.67160504428358d-15*y+1.27876280158297d-14)*y-1.296
     1476623788d-12)*y+1.477175434354d-11)*y+5.464102147892d-10)*y-2.425
     238340602723d-08)*y+8.20460740637617d-07)*y-2.20379304598661d-05)*y
     3+4.90295372978785d-04)*y-9.14294111576119d-03)*y+1.22590403403690d
     4-01
      rt3=(((((((((1.39017367502123d-14*y-6.96391385426890d-13)*y+1.1769
     146020731d-12)*y+1.725627235645d-10)*y-3.686383856300d-09)*y+2.8749
     25324207095d-08)*y+1.71307311000282d-06)*y-7.94273603184629d-05)*y+
     32.00938064965897d-03)*y-3.63329491677178d-02)*y+4.34393683888443d-
     401
      rt4=((((((((((-1.27815158195209d-14*y+1.99910415869821d-14)*y+3.75
     13542914426d-12)*y-2.708018219579d-11)*y-1.190574776587d-09)*y+1.10
     26696436509d-08)*y+3.954955671326d-07)*y-4.398596059588d-06)*y-2.01
     3087998907735d-04)*y+7.89092425542937d-03)*y-1.42056749162695d-01)*
     4y+1.39964149420683d+00
      rt5=((((((((((-1.19442341030461d-13*y-2.34074833275956d-12)*y+6.86
     11649627426d-12)*y+6.082671496226d-10)*y+5.381160105420d-09)*y-6.25
     23297138700d-08)*y-2.135966835050d-06)*y-2.373394341886d-05)*y+2.88
     3711171412814d-06)*y+4.85221195290753d-02)*y-1.04346091985269d+00)*
     4y+7.89901551676692d+00
      ww1=(((((((((7.95526040108997d-15*y-2.48593096128045d-13)*y+4.7612
     146208720d-12)*y-9.535763686605d-11)*y+2.225273630974d-09)*y-4.4979
     26778054865d-08)*y+9.17812870287386d-07)*y-1.86764236490502d-05)*y+
     33.76807779068053d-04)*y-8.10456360143408d-03)*y+2.01097936411496d-
     401
      ww2=(((((((((((1.25678686624734d-15*y-2.34266248891173d-14)*y+3.97
     13252415832d-13)*y-6.830539401049d-12)*y+1.140771033372d-10)*y-1.82
     2546185762009d-09)*y+2.77209637550134d-08)*y-4.01726946190383d-07)*
     3y+5.48227244014763d-06)*y-6.95676245982121d-05)*y+8.05193921815776
     4d-04)*y-8.15528438784469d-03)*y+9.71769901268114d-02
      ww3=((((((((((((-8.20929494859896d-16*y+1.37356038393016d-14)*y-2.
     1022863065220d-13)*y+3.058055403795d-12)*y-4.387890955243d-11)*y+5.
     2923946274445d-10)*y-7.503659964159d-09)*y+8.851599803902d-08)*y-9.
     365561998415038d-07)*y+9.60884622778092d-06)*y-8.56551787594404d-05
     4)*y+6.66057194311179d-04)*y-4.17753183902198d-03)*y+2.254438268524
     547d-02
      ww4=((((((((((((((-1.08764612488790d-17*y+1.85299909689937d-16)*y-
     12.730195628655d-15)*y+4.127368817265d-14)*y-5.881379088074d-13)*y+
     27.805245193391d-12)*y-9.632707991704d-11)*y+1.099047050624d-09)*y-
     31.15042731790748d-08)*y+1.09415155268932d-07)*y-9.33687124875935d-
     407)*y+7.02338477986218d-06)*y-4.53759748787756d-05)*y+2.4172251138
     59146d-04)*y-9.75935943447037d-04)*y+2.57520532789644d-03
      ww5=(((((((((((((((7.28996979748849d-19*y-1.26518146195173d-17)*y+
     11.886145834486d-16)*y-2.876728287383d-15)*y+4.114588668138d-14)*y-
     25.44436631413933d-13)*y+6.64976446790959d-12)*y-7.44560069974940d-
     311)*y+7.57553198166848d-10)*y-6.92956101109829d-09)*y+5.6222285903
     43624d-08)*y-3.97500114084351d-07)*y+2.39039126138140d-06)*y-1.1802
     53950002105d-05)*y+4.52254031046244d-05)*y-1.21113782150370d-04)*y+
     61.75013126731224d-04
      return
c
c     x=10.0 to 15.0                             nroots = 5
c
   40 y=x-12.5d+00
      rt1=((((((((((-4.16387977337393d-17*y+7.20872997373860d-16)*y+1.39
     15993802064d-14)*y+3.660484641252d-14)*y-4.154857548139d-12)*y+2.30
     21379846544d-11)*y-1.033307012866d-09)*y+3.997777641049d-08)*y-9.35
     3118186333939d-07)*y+2.38589932752937d-05)*y-5.35185183652937d-04)*
     4y+8.85218988709735d-03
      rt2=((((((((((-4.56279214732217d-16*y+6.24941647247927d-15)*y+1.73
     17896339191d-13)*y+8.964205979517d-14)*y-3.538906780633d-11)*y+9.56
     21341254948d-11)*y-9.772831891310d-09)*y+4.240340194620d-07)*y-1.02
     3384302866534d-05)*y+2.57987709704822d-04)*y-5.54735977651677d-03)*
     4y+8.68245143991948d-02
      rt3=((((((((((-2.52879337929239d-15*y+2.13925810087833d-14)*y+7.88
     14307667104d-13)*y-9.023398159510d-13)*y-5.814101544957d-11)*y-1.33
     23480437968d-09)*y-2.217064940373d-08)*y+1.643290788086d-06)*y-4.39
     3602147345028d-05)*y+1.08648982748911d-03)*y-2.13014521653498d-02)*
     4y+2.94150684465425d-01
      rt4=((((((((((-6.42391438038888d-15*y+5.37848223438815d-15)*y+8.96
     10828117859d-13)*y+5.214153461337d-11)*y-1.106601744067d-10)*y-2.00
     27890743962d-08)*y+1.543764346501d-07)*y+4.520749076914d-06)*y-1.88
     3893338587047d-04)*y+4.73264487389288d-03)*y-7.91197893350253d-02)*
     4y+8.60057928514554d-01
      rt5=(((((((((((-2.24366166957225d-14*y+4.87224967526081d-14)*y+5.5
     187369053655d-12)*y-3.045253104617d-12)*y-1.223983883080d-09)*y-2.0
     25603889396319d-09)*y+2.58604071603561d-07)*y+1.34240904266268d-06)
     3*y-5.72877569731162d-05)*y-9.56275105032191d-04)*y+4.2336701037092
     41d-02)*y-5.76800927133412d-01)*y+3.87328263873381d+00
      ww1=(((((((((8.98007931950169d-15*y+7.25673623859497d-14)*y+5.8514
     194250405d-14)*y-4.234204823846d-11)*y+3.911507312679d-10)*y-9.6509
     24802088511d-09)*y+3.42197444235714d-07)*y-7.51821178144509d-06)*y+
     31.94218051498662d-04)*y-5.38533819142287d-03)*y+1.68122596736809d-
     401
      ww2=((((((((((-1.05490525395105d-15*y+1.96855386549388d-14)*y-5.50
     10330153548d-13)*y+1.003849567976d-11)*y-1.720997242621d-10)*y+3.53
     23277061402d-09)*y-6.389171736029d-08)*y+1.046236652393d-06)*y-1.73
     3148206795827d-05)*y+2.57820531617185d-04)*y-3.46188265338350d-03)*
     4y+7.03302497508176d-02
      ww3=(((((((((((3.60020423754545d-16*y-6.24245825017148d-15)*y+9.94
     15311467434d-14)*y-1.749051512721d-12)*y+2.768503957853d-11)*y-4.08
     2688551136506d-10)*y+6.04189063303610d-09)*y-8.23540111024147d-08)*
     3y+1.01503783870262d-06)*y-1.20490761741576d-05)*y+1.26928442448148
     4d-04)*y-1.05539461930597d-03)*y+1.15543698537013d-02
      ww4=(((((((((((((2.51163533058925d-18*y-4.31723745510697d-17)*y+6.
     1557620865832d-16)*y-1.016528519495d-14)*y+1.491302084832d-13)*y-2.
     206638666222265d-12)*y+2.67958697789258d-11)*y-3.23322654638336d-10
     3)*y+3.63722952167779d-09)*y-3.75484943783021d-08)*y+3.491642619871
     484d-07)*y-2.92658670674908d-06)*y+2.12937256719543d-05)*y-1.194341
     530620929d-04)*y+6.45524336158384d-04
      ww5=((((((((((((((-1.29043630202811d-19*y+2.16234952241296d-18)*y-
     13.107631557965d-17)*y+4.570804313173d-16)*y-6.301348858104d-15)*y+
     28.031304476153d-14)*y-9.446196472547d-13)*y+1.018245804339d-11)*y-
     39.96995451348129d-11)*y+8.77489010276305d-10)*y-6.84655877575364d-
     409)*y+4.64460857084983d-08)*y-2.66924538268397d-07)*y+1.2462127626
     55907d-06)*y-4.30868944351523d-06)*y+9.94307982432868d-06
      return
   50 if (x.gt.25.0d+00) go to 70
      if (x.gt.20.0d+00) go to 60
c
c     x=15.0 to 20.0                             nroots = 5
c
      y=x-17.5d+00
      rt1=((((((((((1.91875764545740d-16*y+7.8357401095707d-16)*y-3.2608
     175931644d-14)*y-1.186752035569d-13)*y+4.275180095653d-12)*y+3.3570
     256136731d-11)*y-1.123776903884d-09)*y+1.231203269887d-08)*y-3.9985
     31421361031d-07)*y+1.45418822817771d-05)*y-3.49912254976317d-04)*y+
     46.67768703938812d-03
      rt2=((((((((((2.02778478673555d-15*y+1.01640716785099d-14)*y-3.385
     1363492036d-13)*y-1.615655871159d-12)*y+4.527419140333d-11)*y+3.853
     2670706486d-10)*y-1.184607130107d-08)*y+1.347873288827d-07)*y-4.477
     388241748377d-06)*y+1.54942754358273d-04)*y-3.55524254280266d-03)*y
     4+6.44912219301603d-02
      rt3=((((((((((7.79850771456444d-15*y+6.00464406395001d-14)*y-1.249
     1779730869d-12)*y-1.020720636353d-11)*y+1.814709816693d-10)*y+1.766
     2397336977d-09)*y-4.603559449010d-08)*y+5.863956443581d-07)*y-2.037
     397212506691d-05)*y+6.31405161185185d-04)*y-1.30102750145071d-02)*y
     4+2.10244289044705d-01
      rt4=(((((((((((-2.92397030777912d-15*y+1.94152129078465d-14)*y+4.8
     159447665850d-13)*y-3.217227223463d-12)*y-7.484522135512d-11)*y+7.1
     29101516047753d-10)*y+6.88409355245582d-09)*y-1.44374545515769d-07)
     3*y+2.74941013315834d-06)*y-1.02790452049013d-04)*y+2.5992422137264
     43d-03)*y-4.35712368303551d-02)*y+5.62170709585029d-01
      rt5=(((((((((((1.17976126840060d-14*y+1.24156229350669d-13)*y-3.89
     12741622280d-12)*y-7.755793199043d-12)*y+9.492190032313d-10)*y-4.98
     2680128123353d-09)*y-1.81502268782664d-07)*y+2.69463269394888d-06)*
     3y+2.50032154421640d-05)*y-1.33684303917681d-03)*y+2.29121951862538
     4d-02)*y-2.45653725061323d-01)*y+1.89999883453047d+00
      ww1=((((((((((1.74841995087592d-15*y-6.95671892641256d-16)*y-3.000
     1659497257d-13)*y+2.021279817961d-13)*y+3.853596935400d-11)*y+1.461
     2418533652d-10)*y-1.014517563435d-08)*y+1.132736008979d-07)*y-2.866
     305475073259d-06)*y+1.21958354908768d-04)*y-3.86293751153466d-03)*y
     4+1.45298342081522d-01
      ww2=((((((((((-1.11199320525573d-15*y+1.85007587796671d-15)*y+1.22
     10613939709d-13)*y+1.275068098526d-12)*y-5.341838883262d-11)*y+6.16
     21037256669d-10)*y-1.009147879750d-08)*y+2.907862965346d-07)*y-6.12
     3300038720919d-06)*y+1.00104454489518d-04)*y-1.80677298502757d-03)*
     4y+5.78009914536630d-02
      ww3=((((((((((-9.49816486853687d-16*y+6.67922080354234d-15)*y+2.60
     16163540537d-15)*y+1.983799950150d-12)*y-5.400548574357d-11)*y+6.63
     28043374114d-10)*y-8.799518866802d-09)*y+1.791418482685d-07)*y-2.96
     3075397351101d-06)*y+3.38028206156144d-05)*y-3.58426847857878d-04)*
     4y+8.39213709428516d-03
      ww4=(((((((((((1.33829971060180d-17*y-3.44841877844140d-16)*y+4.74
     15009557656d-15)*y-6.033814209875d-14)*y+1.049256040808d-12)*y-1.70
     2859789556117d-11)*y+2.15219425727959d-10)*y-2.52746574206884d-09)*
     3y+3.27761714422960d-08)*y-3.90387662925193d-07)*y+3.46340204593870
     4d-06)*y-2.43236345136782d-05)*y+3.54846978585226d-04
      ww5=(((((((((((((2.69412277020887d-20*y-4.24837886165685d-19)*y+6.
     1030500065438d-18)*y-9.069722758289d-17)*y+1.246599177672d-15)*y-1.
     256872999797549d-14)*y+1.87305099552692d-13)*y-2.09498886675861d-12
     3)*y+2.11630022068394d-11)*y-1.92566242323525d-10)*y+1.620124363440
     469d-09)*y-1.23621614171556d-08)*y+7.72165684563049d-08)*y-3.598589
     501591047d-07)*y+2.43682618601000d-06
      return
c
c     x=20.0 to 25.0                             nroots = 5
c
   60 y=x-22.5d+00
      rt1=(((((((((-1.13927848238726d-15*y+7.39404133595713d-15)*y+1.445
     1982921243d-13)*y-2.676703245252d-12)*y+5.823521627177d-12)*y+2.172
     264723874381d-10)*y+3.56242145897468d-09)*y-3.03763737404491d-07)*y
     3+9.46859114120901d-06)*y-2.30896753853196d-04)*y+5.24663913001114d
     4-03
      rt2=((((((((((2.89872355524581d-16*y-1.22296292045864d-14)*y+6.184
     1065097200d-14)*y+1.649846591230d-12)*y-2.729713905266d-11)*y+3.709
     2913790650d-11)*y+2.216486288382d-09)*y+4.616160236414d-08)*y-3.323
     380270861364d-06)*y+9.84635072633776d-05)*y-2.30092118015697d-03)*y
     4+5.00845183695073d-02
      rt3=((((((((((1.97068646590923d-15*y-4.89419270626800d-14)*y+1.136
     1466605916d-13)*y+7.546203883874d-12)*y-9.635646767455d-11)*y-8.295
     2965491209d-11)*y+7.534109114453d-09)*y+2.699970652707d-07)*y-1.429
     382334217081d-05)*y+3.78290946669264d-04)*y-8.03133015084373d-03)*y
     4+1.58689469640791d-01
      rt4=((((((((((1.33642069941389d-14*y-1.55850612605745d-13)*y-7.522
     1712577474d-13)*y+3.209520801187d-11)*y-2.075594313618d-10)*y-2.070
     2575894402d-09)*y+7.323046997451d-09)*y+1.851491550417d-06)*y-6.375
     324802411383d-05)*y+1.36795464918785d-03)*y-2.42051126993146d-02)*y
     4+3.97847167557815d-01
      rt5=((((((((((-6.07053986130526d-14*y+1.04447493138843d-12)*y-4.28
     16617818951d-13)*y-2.632066100073d-10)*y+4.804518986559d-09)*y-1.83
     25675889421d-08)*y-1.068175391334d-06)*y+3.292234974141d-05)*y-5.94
     3805357558251d-04)*y+8.29382168612791d-03)*y-9.93122509049447d-02)*
     4y+1.09857804755042d+00
      ww1=(((((((((-9.10338640266542d-15*y+1.00438927627833d-13)*y+7.817
     1349237071d-13)*y-2.547619474232d-11)*y+1.479321506529d-10)*y+1.523
     214028857627d-09)*y+9.20072040917242d-09)*y-2.19427111221848d-06)*y
     3+8.65797782880311d-05)*y-2.82718629312875d-03)*y+1.28718310443295d
     4-01
      ww2=(((((((((5.52380927618760d-15*y-6.43424400204124d-14)*y-2.3587
     134508092d-13)*y+8.261326648131d-12)*y+9.229645304956d-11)*y-5.6810
     28973828949d-09)*y+1.22477891136278d-07)*y-2.11919643127927d-06)*y+
     34.23605032368922d-05)*y-1.14423444576221d-03)*y+5.06607252890186d-
     402
      ww3=(((((((((3.99457454087556d-15*y-5.11826702824182d-14)*y-4.1575
     193182747d-14)*y+4.214670817758d-12)*y+6.705582751532d-11)*y-3.3608
     26411698418d-09)*y+6.07453633298986d-08)*y-7.40736211041247d-07)*y+
     38.84176371665149d-06)*y-1.72559275066834d-04)*y+7.16639814253567d-
     403
      ww4=(((((((((((-2.14649508112234d-18*y-2.45525846412281d-18)*y+6.1
     126212599772d-16)*y-8.526651626939d-15)*y+4.826636065733d-14)*y-3.3
     29554163649740d-13)*y+1.67070784862985d-11)*y-4.42671979311163d-10)
     3*y+6.77368055908400d-09)*y-7.03520999708859d-08)*y+6.0499329470887
     44d-07)*y-7.80555094280483d-06)*y+2.85954806605017d-04
      ww5=((((((((((((-5.63938733073804d-21*y+6.92182516324628d-20)*y-1.
     1586937691507d-18)*y+3.357639744582d-17)*y-4.810285046442d-16)*y+5.
     2386312669975d-15)*y-6.117895297439d-14)*y+8.441808227634d-13)*y-1.
     318527596836592d-11)*y+1.36296870441445d-10)*y-1.17842611094141d-09
     4)*y+7.80430641995926d-09)*y-5.97767417400540d-08)*y+1.651861460949
     569d-06
      return
   70 ww1=sqrt(pie4/x)
      if (x.gt.40.0d+00) go to 80
c
c     x=25.0 to 40.0                             nroots = 5
c
      g= exp(-x)
      rt1=((((((((-1.73363958895356d-06*x+1.19921331441483d-04)*x-1.5943
     17614121125d-02)*x+1.13467897349442d+00)*x-4.47216460864586d+01)*x+
     21.06251216612604d+03)*x-1.52073917378512d+04)*x+1.20662887111273d+
     305)*x-4.07186366852475d+05)*g+r15/(x-r15)
      rt2=((((((((-1.60102542621710d-05*x+1.10331262112395d-03)*x-1.5004
     13662589017d-01)*x+1.05563640866077d+01)*x-4.10468817024806d+02)*x+
     29.62604416506819d+03)*x-1.35888069838270d+05)*x+1.06107577038340d+
     306)*x-3.51190792816119d+06)*g+r25/(x-r25)
      rt3=((((((((-4.48880032128422d-05*x+2.69025112122177d-03)*x-4.0104
     18115525954d-01)*x+2.78360021977405d+01)*x-1.04891729356965d+03)*x+
     22.36985942687423d+04)*x-3.19504627257548d+05)*x+2.34879693563358d+
     306)*x-7.16341568174085d+06)*g+r35/(x-r35)
      rt4=((((((((-6.38526371092582d-05*x-2.29263585792626d-03)*x-7.6573
     15935499627d-02)*x+9.12692349152792d+00)*x-2.32077034386717d+02)*x+
     22.81839578728845d+02)*x+9.59529683876419d+04)*x-1.77638956809518d+
     306)*x+1.02489759645410d+07)*g+r45/(x-r45)
      rt5=((((((((-3.59049364231569d-05*x-2.25963977930044d-02)*x+1.1259
     14870794668d+00)*x-4.56752462103909d+01)*x+1.05804526830637d+03)*x-
     21.16003199605875d+04)*x-4.07297627297272d+04)*x+2.22215528319857d+
     306)*x-1.61196455032613d+07)*g+r55/(x-r55)
      ww5=(((((((((-4.61100906133970d-10*x+1.43069932644286d-07)*x-1.639
     160915431080d-05)*x+1.15791154612838d-03)*x-5.30573476742071d-02)*x
     2+1.61156533367153d+00)*x-3.23248143316007d+01)*x+4.12007318109157d
     3+02)*x-3.02260070158372d+03)*x+9.71575094154768d+03)*g+w55*ww1
      ww4=(((((((((-2.40799435809950d-08*x+8.12621667601546d-06)*x-9.044
     191430884113d-04)*x+6.37686375770059d-02)*x-2.96135703135647d+00)*x
     2+9.15142356996330d+01)*x-1.86971865249111d+03)*x+2.42945528916947d
     3+04)*x-1.81852473229081d+05)*x+5.96854758661427d+05)*g+w45*ww1
      ww3=((((((((1.83574464457207d-05*x-1.54837969489927d-03)*x+1.18520
     1453711586d-01)*x-6.69649981309161d+00)*x+2.44789386487321d+02)*x-5
     2.68832664556359d+03)*x+8.14507604229357d+04)*x-6.55181056671474d+0
     35)*x+2.26410896607237d+06)*g+w35*ww1
      ww2=((((((((2.77778345870650d-05*x-2.22835017655890d-03)*x+1.61077
     1633475573d-01)*x-8.96743743396132d+00)*x+3.28062687293374d+02)*x-7
     2.65722701219557d+03)*x+1.10255055017664d+05)*x-8.92528122219324d+0
     35)*x+3.10638627744347d+06)*g+w25*ww1
      ww1=ww1-0.01962d+00*g-ww2-ww3-ww4-ww5
      return
   80 if (x.gt.59.0d+00) go to 90
c
c     x=40.0 to 59.0                             nroots = 5
c
      xxx=x**3
      g=xxx* exp(-x)
      rt1=(((-2.43758528330205d-02*x+2.07301567989771d+00)*x-6.459642253
     181113d+01)*x+7.14160088655470d+02)*g+r15/(x-r15)
      rt2=(((-2.28861955413636d-01*x+1.93190784733691d+01)*x-5.997747303
     140912d+02)*x+6.61844165304871d+03)*g+r25/(x-r25)
      rt3=(((-6.95053039285586d-01*x+5.76874090316016d+01)*x-1.777041432
     125520d+03)*x+1.95366082947811d+04)*g+r35/(x-r35)
      rt4=(((-1.58072809087018d+00*x+1.27050801091948d+02)*x-3.866873509
     114280d+03)*x+4.23024828121420d+04)*g+r45/(x-r45)
      rt5=(((-3.33963830405396d+00*x+2.51830424600204d+02)*x-7.577285276
     154961d+03)*x+8.21966816595690d+04)*g+r55/(x-r55)
      g=xxx*g
      ww5=((1.35482430510942d-08*x-3.27722199212781d-07)*x+2.41522703684
     1296d-06)*g+w55*ww1
      ww4=((1.23464092261605d-06*x-3.55224564275590d-05)*x+3.03274662192
     1286d-04)*g+w45*ww1
      ww3=((1.34547929260279d-05*x-4.19389884772726d-04)*x+3.87706687610
     1809d-03)*g+w35*ww1
      ww2=((2.09539509123135d-05*x-6.87646614786982d-04)*x+6.68743788585
     1688d-03)*g+w25*ww1
      ww1=ww1-ww2-ww3-ww4-ww5
      return
c
c     x=59.0 to infinity                         nroots = 5
c
   90 rt1=r15/(x-r15)
      rt2=r25/(x-r25)
      rt3=r35/(x-r35)
      rt4=r45/(x-r45)
      rt5=r55/(x-r55)
      ww2=w25*ww1
      ww3=w35*ww1
      ww4=w45*ww1
      ww5=w55*ww1
      ww1=ww1-ww2-ww3-ww4-ww5
      return
c
      end
c==============================================================================
      subroutine root6
      implicit double precision (a-h,o-z)
c        *****  this routine evaluates rys roots and weights    *****
c        *****  using the christoffel formula for weights.      *****
c        *****  ith root of the jth rys polynomial is returned  *****
c        *****  in r(i,j) with the corresponding weight factor  *****
c        *****  in w(i,j).   j=1,2,...,n                        *****
c
      common /rys/ xx,uf(10),wf(10),t,f0,f1,f2,f3,f4,f5,nroots
      common/ffm  / ff(19)
      common/roots/ r(9,9),w(9,9)
      dimension c(10,10),s(10,10),a(10),rt(10)
c
      n = nroots
      x = xx
      if(n.lt.2) n=2
      n1 = n+1
      nn = n+n
      call dfunc(x,nn)
      do 10 i=1,n1
      do 10 j=1,n1
   10 s(i,j) = ff(i+j-1)
      call dsmit(c,s,n1)
      do 20 i=1,n
      do 20 j=1,i
      w(i,j) = 0.0d+00
   20 r(i,j) = 0.0d+00
      wsum = ff(1)
      w(1,1) = wsum
      r(1,1) = ff(2)/wsum
      dum = sqrt(c(2,3)**2-4.0d+00*c(1,3)*c(3,3))
      r(1,2) = 0.5d+00*(-c(2,3)-dum)/c(3,3)
      r(2,2) = 0.5d+00*(-c(2,3)+dum)/c(3,3)
      if(n.eq.2) go to 70
      do 25 i=3,n1
   25 rt(i) = 1.0d+00
      rt(1) = r(1,2)
      rt(2) = r(2,2)
      do 60 k=3,n
      k1 = k+1
      do 30 i=1,k1
   30 a(i) = c(i,k1)
      call dnode(a,rt,k)
      do 50 i=1,k
   50 r(i,k) = rt(i)
   60 continue
   70 do 150 k=2,n
      jmax = k-1
      do 150 i=1,k
      root = r(i,k)
      dum = 1.0d+00/ff(1)
      do 110 j=1,jmax
      j1 = j+1
      poly = c(j1,j1)
      do 100 m=1,j
  100 poly = poly*root+c(j1-m,j1)
  110 dum = dum+poly*poly
  150 w(i,k) = 1.d+00/dum
      do 160 k=1,nroots
      dum = r(k,nroots)
      uf(k) = dum/(1.0d+00-dum)
  160 wf(k) = w(k,nroots)
      return
      end
c==============================================================================
      subroutine dsmit(c,s,n)
      implicit double precision (a-h,o-z)
c        *****  routine returns an n by n triangular matrix     *****
c        *****  c such that:  c(transpose)sc=i,  where i is     *****
c        *****  an n by n identity matrix.                      *****
c
      dimension c(10,10),s(10,10),v(10),y(10)
c
      do 10 i=1,n
      do 10 j=1,i
   10 c(i,j) = 0.0d+00
      do 100 j=1,n
      kmax = j-1
      fac = s(j,j)
      if(kmax.eq.0) go to 60
      do 20 k=1,kmax
      v(k) = 0.0d+00
   20 y(k) = s(k,j)
      do 50 k=1,kmax
      dot = 0.0d+00
      do 30 i=1,k
   30 dot = c(i,k)*y(i)+dot
      do 40 i=1,k
   40 v(i) = v(i)-dot*c(i,k)
   50 fac = fac-dot*dot
   60 fac = 1.0d+00/sqrt(fac)
      c(j,j) = fac
      if(kmax.eq.0) go to 100
      do 70 k=1,kmax
   70 c(k,j) = fac*v(k)
  100 continue
      return
      end
c==============================================================================
      subroutine dfunc(x,n)
      implicit double precision (a-h,o-z)
c        ***** routine evaluates the incomplete gamma function  *****
c
      common/ffm  / ff(19)
      tol = 1.0d-29
      xx = x+x
      facmin = xx
      e = 1.0d-78
      if(facmin.lt.360.0d+00) e= exp(-x)
      if(facmin.gt.80.0d+00) go to 100
      term = 1.0d+00
      sum = 1.0d+00
      fac = n
      fac = fac+0.5d+00
   10 fac = fac+1.0d+00
      term = term*x/fac
      sum = sum+term
      if(fac.le.facmin) go to 10
      t = term
      s = sum
      if(t.gt.s*tol) go to 10
      fac = n+n+1
      ff(n+1) = sum*e/fac
      m = n-1
      fac = m+m+1
   20 if(m.lt.0) return
      ff(m+1) = (e+xx*ff(m+2))/fac
      m = m-1
      fac = fac-2.0d+00
      go to 20
c        ***** use asymptotic expansion for large arguments.    *****
  100 a = sqrt(.7853981633974483096156608d+00/x)
      tmax = a*tol/e
      term = 1.0d+00/xx
      sum = term
      fac = 1.0d+00
  110 fac = fac-2.0d+00
      term = fac*term/xx
      sum = term+sum
      t = term
      if(abs(t).gt.tmax) go to 110
      ff(1) = a-e*sum
      fac = -1.0d+00
      m = 0
  120 if(m.eq.n) return
      m = m+1
      fac = fac+2.0d+00
      ff(m+1) = (fac*ff(m)-e)/xx
      go to 120
      end
c==============================================================================
      subroutine dnode(a,rt,k)
      implicit double precision (a-h,o-z)
c        *****  routine returns in rt(i) the ith root of        *****
c        *****  a polynomial of order k whose mth coefficient   *****
c        *****  is stored in a(m+1).  it is assumed that the    *****
c        *****  initial values in rt bracket the final values.  *****
      dimension a(10),rt(10)
c
c **** this program originally was caught in an infinite loop
c      between statements 45 and 60. a change in the condition
c      at the statement if... go to 60 was made which cured the
c      problem but the accuracy may be not as high as desirable
c      P. Pulay, march 13, 1987.
c      Note 9/20/2005: Now I get another infinite loop, between
c      "if(prod.lt.tol) go to 30" and ? for n=9
c     tol = 2.0d-15
c   Limit the number of cycles
      maxcycle=500
      tol= 1.0d-9
      k1=k+1
      r2=0.0d+00
      p2=a(1)
      icycle=0
      do 100 m=1,k
      r1=r2
      p1=p2
      r2=rt(m)
      p2=a(k1)
      do 10 i=1,k
   10 p2=p2*r2+a(k1-i)
      prod=p1*p2
      if(prod.lt.0.0d+00) go to 20
      call nerror(1,'dnode',' was unable to find root no. ',m,k)
c      write(8,15) m,k
c      write(9,15) m,k
   15 format(/' root number',i3,' was not found for polynomial of order'
     1 ,i3,/)
      call exit
   20 r5=r1
      p5=p1
      r6=r2
      p6=p2
   30 r3=r5
      p3=p5
      r4=r6
      p4=p6
      r =(r3*p4-r4*p3)/(p4-p3)
      dr=r4-r3
      delta=dr
      if(dabs(delta).lt.tol) go to 90
      dr=0.0625d+00*dr
      r5=r-dr
      if(r5.lt.r3) r5=r3
      r6=r+dr
      if(r6.gt.r4) r6=r4
      p5=a(k1)
      p6=p5
      do 40 i=1,k
      p5=p5*r5+a(k1-i)
   40 p6=p6*r6+a(k1-i)
   45 prod=p5*p6
CPP
      icycle=icycle+1
      if(icycle.gt.maxcycle) then
c        print *, 'Stopping at root',m,' cycle=',icycle
      call nerror(2,'dnode','maximum iterations reached, root, cycle=',
     1            m,icycle)
        rt(m)=r
        return
      end if
      if(prod.lt.tol) go to 30
      prod=p3*p5
      if(prod.gt.tol) go to 60
      r5=0.25d+00*r3+0.75d+00*r5
      p5=a(k1)
      do 50 i=1,k
   50 p5=p5*r5+a(k1-i)
      go to 45
   60 r6=0.25d+00*r4+0.75d+00*r6
      p6=a(k1)
      do 70 i=1,k
   70 p6=p6*r6+a(k1-i)
      go to 45
   90 rt(m)=r
  100 continue
c  Polish roots
      do m=1,k
        x=rt(m)
1000      p=a(k+1)*x+a(k)
          p1=a(k+1)
          do i=k-1,1,-1
            p1=p+p1*x
            p=a(i)+p*x
          end do
          del=p/p1
          if(abs(del).gt.0.5d-12) then
c            print *, k,m,del
            x=x-del
          go to 1000
        end if
      rt(m)=x
      end do
      return
      end

c==============================================================================
